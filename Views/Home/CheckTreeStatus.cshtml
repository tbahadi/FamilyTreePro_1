@{
    ViewData["Title"] = "فحص حالة الشجرة";
}

<div class="container mt-4" dir="rtl">
    <h2 class="text-center mb-4">فحص حالة الشجرة</h2>

    <div class="card">
        <div class="card-header bg-info text-white">
            <h5>@ViewBag.Tree.Name</h5>
        </div>
        <div class="card-body">
            <h6>معلومات الشجرة:</h6>
            <ul>
                <li><strong>الرقم:</strong> @ViewBag.Tree.Id</li>
                <li><strong>الاسم:</strong> @ViewBag.Tree.Name</li>
                <li><strong>الوصف:</strong> @ViewBag.Tree.Description</li>
                <li><strong>تاريخ الإنشاء:</strong> @ViewBag.Tree.CreatedDate.ToString("yyyy/MM/dd")</li>
            </ul>

            <h6>حالة الحذف:</h6>
            <div class="alert @(ViewBag.CanDelete ? "alert-success" : "alert-danger")">
                @if (ViewBag.CanDelete)
                {
                    <p><i class="fas fa-check-circle"></i> <strong>يمكن حذف الشجرة</strong></p>
                    <p class="mb-0">لا توجد أفراد أو شجرات فرعية مرتبطة بهذه الشجرة.</p>
                }
                else
                {
                    <p><i class="fas fa-exclamation-triangle"></i> <strong>لا يمكن حذف الشجرة</strong></p>
                    <ul>
                        @if (ViewBag.PersonCount > 0)
                        {
                            <li>يوجد @ViewBag.PersonCount فرد مرتبط بالشجرة</li>
                        }
                        @if (ViewBag.ChildTreeCount > 0)
                        {
                            <li>يوجد @ViewBag.ChildTreeCount شجرة فرعية مرتبطة بالشجرة</li>
                        }
                    </ul>
                }
            </div>
        </div>
        <div class="card-footer">
            <a href="@Url.Action("Index", "Home")" class="btn btn-secondary">العودة</a>
            @if (ViewBag.CanDelete)
            {
                <a href="@Url.Action("DeleteTree", "Home", new { id = ViewBag.Tree.Id })" class="btn btn-danger">حذف الشجرة</a>
            }
            else
            {
                <a href="@Url.Action("Index", "Person", new { familyTreeId = ViewBag.Tree.Id })" class="btn btn-info">عرض الأفراد</a>
            }
        </div>
    </div>
</div>